# âœ… SQLite3 é—®é¢˜å·²è§£å†³

## ğŸ‰ è‡ªåŠ¨åˆ‡æ¢åˆ° better-sqlite3

ä¸ºäº†è§£å†³ `sqlite3` åœ¨ Windows ä¸Šçš„å®‰è£…é—®é¢˜ï¼Œæˆ‘ä»¬å·²ç»è‡ªåŠ¨åˆ‡æ¢åˆ° **better-sqlite3**ã€‚

---

## ğŸ“¦ å®‰è£…æ­¥éª¤

åªéœ€è¿è¡Œæ ‡å‡†çš„ä¾èµ–å®‰è£…å‘½ä»¤ï¼š

```cmd
npm install
```

**better-sqlite3** çš„ä¼˜åŠ¿ï¼š
- âœ… å®‰è£…æˆåŠŸç‡æ›´é«˜ï¼ˆé¢„ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰
- âœ… æ€§èƒ½æ›´å¥½ï¼ˆåŒæ­¥APIï¼Œæ— å›è°ƒå¼€é”€ï¼‰
- âœ… API æ›´ç®€æ´ç›´è§‚
- âœ… ç»´æŠ¤æ›´æ´»è·ƒ

---

## ğŸ” éªŒè¯å®‰è£…

æ£€æŸ¥ä¾èµ–æ˜¯å¦å®‰è£…æˆåŠŸï¼š

```cmd
# æŸ¥çœ‹å·²å®‰è£…çš„åŒ…
npm list better-sqlite3

# åº”è¯¥è¾“å‡ºç±»ä¼¼ï¼š
# pet-health-daily@1.0.0
# â””â”€â”€ better-sqlite3@9.4.0
```

---

## ğŸš€ å¯åŠ¨ç³»ç»Ÿ

å®‰è£…å®Œæˆåï¼Œç›´æ¥å¯åŠ¨ï¼š

```cmd
# ä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬
scripts\start.bat

# æˆ–æ‰‹åŠ¨å¯åŠ¨
npm run dev
```

---

## ğŸ“ ä»£ç æ”¹åŠ¨è¯´æ˜

### å·²è‡ªåŠ¨å®Œæˆçš„æ”¹åŠ¨

1. **package.json**
   - ç§»é™¤ `sqlite3`
   - æ·»åŠ  `better-sqlite3`

2. **server/config/database.js**
   - åˆ‡æ¢åˆ° `better-sqlite3` API
   - ä¿æŒ Promise æ¥å£å…¼å®¹
   - åŒæ­¥åˆå§‹åŒ–æ•°æ®åº“

### API å¯¹æ¯”

#### åŸä»£ç ï¼ˆsqlite3 - å¼‚æ­¥ï¼‰
```javascript
db.run('INSERT INTO pets VALUES (?, ?)', [id, name], (err) => {
  if (err) console.error(err);
});
```

#### æ–°ä»£ç ï¼ˆbetter-sqlite3 - åŒæ­¥ï¼‰
```javascript
const stmt = db.prepare('INSERT INTO pets VALUES (?, ?)');
stmt.run(id, name);
```

**ä½†å¯¹å¤–æ¥å£ä¿æŒä¸å˜**ï¼Œæ‰€æœ‰è·¯ç”±ä»£ç æ— éœ€ä¿®æ”¹ï¼

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### å¦‚æœ better-sqlite3 å®‰è£…ä»ç„¶å¤±è´¥

#### æ–¹æ¡ˆ1ï¼šä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬
```cmd
npm install better-sqlite3 --build-from-source=false
```

#### æ–¹æ¡ˆ2ï¼šæ¸…ç†åé‡è£…
```cmd
npm cache clean --force
rmdir /s /q node_modules
npm install
```

#### æ–¹æ¡ˆ3ï¼šæ£€æŸ¥ Node.js ç‰ˆæœ¬
```cmd
node --version
# å»ºè®®ä½¿ç”¨ v14.x æˆ–æ›´é«˜ç‰ˆæœ¬
```

---

## ğŸ“‹ æŠ€æœ¯ç»†èŠ‚

### better-sqlite3 vs sqlite3

| ç‰¹æ€§ | better-sqlite3 | sqlite3 |
|------|---------------|---------|
| API é£æ ¼ | åŒæ­¥ | å¼‚æ­¥ï¼ˆå›è°ƒï¼‰ |
| æ€§èƒ½ | æ›´å¿« | è¾ƒæ…¢ |
| å®‰è£…éš¾åº¦ | ç®€å• | å¤æ‚ï¼ˆéœ€è¦ç¼–è¯‘ï¼‰ |
| é¢„ç¼–è¯‘ç‰ˆæœ¬ | âœ… | âŒ |
| Windows æ”¯æŒ | ä¼˜ç§€ | éœ€è¦æ„å»ºå·¥å…· |
| ç»´æŠ¤çŠ¶æ€ | æ´»è·ƒ | ä¸€èˆ¬ |

### ä¸ºä»€ä¹ˆ better-sqlite3 æ›´å¿«ï¼Ÿ

1. **åŒæ­¥API** - æ— å›è°ƒå¼€é”€
2. **æ›´å¥½çš„V8é›†æˆ** - ä¼˜åŒ–çš„ç»‘å®š
3. **æ‰¹é‡æ“ä½œä¼˜åŒ–** - äº‹åŠ¡æ€§èƒ½æ›´å¥½

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [better-sqlite3 å®˜æ–¹æ–‡æ¡£](https://github.com/WiseLibs/better-sqlite3/wiki)
- [SQLite3 å®‰è£…å®Œæ•´æŒ‡å—](SQLITE3-INSTALL.md)
- [è„šæœ¬å‘½ä»¤ç´¢å¼•](SCRIPTS-INDEX.md)

---

## âœ… ç¡®è®¤æ¸…å•

å®‰è£…å®Œæˆåï¼Œè¯·ç¡®è®¤ï¼š

- [ ] `npm install` æ‰§è¡ŒæˆåŠŸ
- [ ] `node_modules/better-sqlite3` ç›®å½•å­˜åœ¨
- [ ] è¿è¡Œ `scripts\start.bat` å¯åŠ¨æˆåŠŸ
- [ ] è®¿é—® http://localhost:3000/admin å¯ä»¥ç™»å½•
- [ ] ç®¡ç†å‘˜è´¦å·å¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼ˆadmin/admin123ï¼‰

---

**é—®é¢˜å·²è§£å†³ï¼ç°åœ¨å¯ä»¥æ­£å¸¸ä½¿ç”¨ç³»ç»Ÿäº†ã€‚** ğŸŠ
